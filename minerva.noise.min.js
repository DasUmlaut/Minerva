Minerva.noise=new function(){var r={seed:0,perm:[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180,151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],permMod8:[],igrad:[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]]},e={random:function(){var r=2*Minerva.Helper.random()-1;return r},classicperlin:function(e,a,n,t){var o,i,v,l,f,p,M,u,c,s,d,h,m,H,b,g,y,T,w,L,A=r.perm;return o=Math.floor(e)%n,i=(o+1)%t,c=e-Math.floor(e),s=c-1,v=Math.floor(a)%n,l=(v+1)%t,d=a-Math.floor(a),h=d-1,w=A[o],L=A[i],f=A[w+v],M=A[L+v],p=A[w+l],u=A[L+l],m=Minerva.Helper.fade(c),H=Minerva.Helper.fade(d),y=Minerva.Helper.grad2(f,c,d),T=Minerva.Helper.grad2(M,s,d),b=Minerva.Helper.lerp(m,y,T),y=Minerva.Helper.grad2(p,c,h),T=Minerva.Helper.grad2(u,s,h),g=Minerva.Helper.lerp(m,y,T),.5*(1+Minerva.Helper.lerp(H,b,g))},improvedperlin:function(e,a,n,t){var o,i,v,l,f,p,M,u,c,s,d,h,m,H,b,g,y,T,w,L,A=r.perm,S=r.permMod8,C=r.igrad;return o=Math.floor(e)%n,i=(o+1)%t,c=e-Math.floor(e),s=c-1,v=Math.floor(a)%n,l=(v+1)%t,d=a-Math.floor(a),h=d-1,w=A[o],L=A[i],f=S[w+v],M=S[L+v],p=S[w+l],u=S[L+l],m=Minerva.Helper.fade(c),H=Minerva.Helper.fade(d),y=c*C[f][0]+d*C[f][1],T=s*C[M][0]+d*C[M][1],b=Minerva.Helper.lerp(m,y,T),y=c*C[p][0]+h*C[p][1],T=s*C[u][0]+h*C[u][1],g=Minerva.Helper.lerp(m,y,T),.5*(1+Minerva.Helper.lerp(H,b,g))}},a={additive:function(r,e){return r+e},subtractive:function(r,e){return r-e},turbulence:function(r,e){Math.abs(e);return r+Math.abs(e)}},n={none:function(r,a,n,o,i,v){var l=e[r](a,n,o,i,v);return t[v.sumationType](l,v)},fBM:function(r,n,o,i,v,l){for(var f=1,p=0,M=0;M<l.octaves;M++){var u=e[r](n,o,i,v,l);p=a[l.octaveType](p,u*f),n*=l.fbmLacunarity,o*=l.fbmLacunarity,i*=l.fbmLacunarity,v*=l.fbmLacunarity,f*=l.fbmPersistence}return t[l.sumationType](p,l)}},t={normal:function(r){return r/2+.5},absolute:function(r){return Math.abs(r)},modular:function(r){return(r+1)%1},threshold:function(r){return r>0?1:0}},o={color:"grayscale",noiseType:"improvedperlin",fractalType:"fBM",octaveType:"additive",sumationType:"normal",scale:1,seed:1,octaves:5,fbmLacunarity:2,fbmPersistence:.5};this.generateChannel=function(r,e,a){var t={};for(var i in o)t[i]=o[i];for(var i in a)t[i]=a[i];t.width=r,t.height=e,Minerva.Helper.setSeed(0==t.seed?Math.random():t.seed);var v=1/64,l=r,f=e,p=new Minerva.Channel;p.setSize(r,e);var M=[];Minerva.Helper.permutate(Math.sqrt(l*f));for(var u=-1e3,c=1e3,s=0;r>s;s++){M[s]=[];for(var d=0;e>d;d++){var h=n[t.fractalType](t.noiseType,v*s,v*d,v*l,v*f,t);M[s][d]=h,c=Math.min(c,h),u=Math.max(u,h)}}for(var m=u-c,s=0;r>s;s++)for(var d=0;e>d;d++)p.setAt(d*r+s,(M[0][s][d]-c)/m);return p},this.generate=function(r,e,a){var t=-1e3,i=1e3,v=new Minerva.Img;v.setSize(r,e);var l={};for(var f in o)l[f]=o[f];for(var f in a)l[f]=a[f];l.width=r,l.height=e,Minerva.Helper.setSeed(0==l.seed?Math.random():l.seed);var p=1/64,M=r,u=e,c=1;"rgb"==l.color?c=3:"rgba"==l.color&&(c=4);for(var s=[],d=0;c>d;d++){Minerva.Helper.permutate(Math.sqrt(M*u)),s[d]=[];for(var h=0;r>h;h++){s[d][h]=[];for(var m=0;e>m;m++){var H=n[l.fractalType](l.noiseType,p*h,p*m,p*M,p*u,l);s[d][h][m]=H,i=Math.min(i,H),t=Math.max(t,H)}}}for(var b=t-i,h=0;r>h;h++)for(var m=0;e>m;m++){var g=0,y=0,T=0,w=1;"grayscale"==l.color?(g=(s[0][h][m]-i)/b,y=(s[0][h][m]-i)/b,T=(s[0][h][m]-i)/b):"rgb"==l.color?(g=(s[0][h][m]-i)/b,y=(s[1][h][m]-i)/b,T=(s[2][h][m]-i)/b):"rgba"==l.color&&(g=(s[0][h][m]-i)/b,y=(s[1][h][m]-i)/b,T=(s[2][h][m]-i)/b,w=(s[3][h][m]-i)/b),v.setColorAt(m*r+h,{r:g,g:y,b:T}),v.setAlphaAt(m*r+h,w)}return v}};
